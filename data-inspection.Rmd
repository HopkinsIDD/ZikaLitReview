---
title: "Plotting/inspecting zika data"
author: "Nicholas Reich"
date: "February 28, 2016"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyr)
library(dplyr)
library(ggplot2)
theme_set(theme_bw())
```


Loading in data and reformatting a bit for easier plotting.
```{r}
dat <- read.csv("ZikaLitReviewData.csv")
dat <- dat %>% separate(UID, into=c("id", "id.obs"), remove=FALSE) %>%
    mutate(ELnew = EL-ER,
           ERnew = ER-ER,
           SLnew = SL-ER,
           SRnew = SR-ER,
           VLnew = VL-ER,
           VRnew = VR-ER,
           ALnew = AL-ER,
           ARnew = AR-ER)
```


## Plotting viral shedding data

In viral shedding data, it stands out that there are some really long (EL, ER) intervals.  Not sure how the analyses are dealing with data with some special situations:

 - in ID 114, there are both green (shedding=0) and red (shedding=1) intervals prior to the last possible exposure time
 - ID 868: in sequence shedding-no shedding-shedding outcomes
 
```{r, shedding-plot}
p <- ggplot(dat, aes(y=factor(id))) + 
    geom_segment(aes(x=ELnew, xend=ERnew, yend=factor(id)), 
                 color="blue", size=2) +
    geom_segment(aes(x=VLnew, xend=VRnew, yend=factor(id), 
                     color=factor(SHEDDING)), size=2) +
    scale_color_manual(values = c("green", "red", "gray")) +
    ggtitle("Viral shedding data") + 
    xlab("time since last possible exposure") +
    ylab("id") + theme(legend.position="bottom")
print(p)
```

Trimming the x-axis for zooming
```{r}
p + coord_cartesian(xlim = c(-10, 50))
```

## Plotting incubation period data

```{r, incper-plot}
p <- ggplot(dat, aes(y=factor(id))) + 
    geom_segment(aes(x=ELnew, xend=ERnew, yend=factor(id)), 
                 color="blue", size=2) +
    geom_segment(aes(x=SLnew, xend=SRnew, yend=factor(id)), size=2, color="red") +
    ggtitle("Incubation Period data") + 
    xlab("time since last possible exposure") +
    ylab("id")
print(p)
```

Trimming the x-axis for zooming
```{r}
p + coord_cartesian(xlim = c(-5, 10))
```

## Plotting antibody detection data

What is up with ID 104? Why the long green tail?

```{r, antibody-plot}
p <- ggplot(dat, aes(y=factor(id))) + 
    geom_segment(aes(x=ELnew, xend=ERnew, yend=factor(id)), 
                 color="blue", size=2) +
    geom_segment(aes(x=ALnew, xend=ARnew, yend=factor(id), 
                     color=factor(ANYANTIBODY)), size=2) +
    scale_color_manual(values = c("green", "red")) +
    ggtitle("Antibody data") + 
    xlab("time since last possible exposure") +
    ylab("id") + theme(legend.position="bottom")
print(p)
```

Trimming the x-axis for zooming
```{r}
p + coord_cartesian(xlim = c(-10, 100))
```
